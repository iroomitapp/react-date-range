"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = DateRange;
var _react = _interopRequireDefault(require("react"));
var _Calendar = _interopRequireDefault(require("../Calendar"));
var _utils = require("../../utils");
var _styles = _interopRequireDefault(require("../../styles"));
var _dateFns = require("date-fns");
var _classnames = _interopRequireDefault(require("classnames"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function DateRange(_ref) {
  let {
    ariaLabels,
    weekStartsOn,
    weekdayDisplayFormat,
    editableDateInputs,
    endDatePlaceholder,
    showMonthAndYearPickers,
    onShownDateChange,
    preventSnapRefocus,
    preview,
    scroll,
    showDateDisplay,
    showMonthArrow,
    showPreview,
    shownDate,
    startDatePlaceholder,
    date,
    dateDisplayFormat,
    dayContentRenderer,
    dayDisplayFormat,
    direction,
    disabledDay,
    dragSelectionEnabled,
    fixedHeight,
    locale,
    calendarFocus,
    className,
    monthDisplayFormat,
    months,
    onChange,
    classNames = {},
    ranges = [],
    moveRangeOnFirstSelection = false,
    retainEndDateOnFirstSelection = false,
    rangeColors = ['#3d91ff', '#3ecf8e', '#fed14c'],
    disabledDates = [],
    initialFocusedRange,
    focusedRange,
    maxDate,
    minDate,
    onRangeFocusChange,
    color,
    previewRange,
    preventScrollToFocusedMonth
  } = _ref;
  const refs = _react.default.useRef({
    styles: (0, _utils.generateStyles)([_styles.default, classNames])
  });
  const [state, setState] = _react.default.useState({
    focusedRange: initialFocusedRange || [(0, _utils.findNextRangeIndex)(ranges, 0)],
    preview: null
  });
  _react.default.useEffect(() => {
    updatePreview(previewRange ? calcNewSelection(previewRange, !previewRange.endDate) : null);
  }, [previewRange]);
  const calcNewSelection = function (value) {
    let isSingleValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
    const focusedRangeInternal = focusedRange || state.focusedRange;
    const focusedRangeIndex = focusedRangeInternal[0];
    const selectedRange = ranges[focusedRangeIndex];
    if (!selectedRange || !onChange) return {};
    let {
      startDate,
      endDate
    } = selectedRange;
    const now = new Date();
    let nextFocusRange;
    if (!isSingleValue) {
      startDate = value.startDate;
      endDate = value.endDate;
    } else if (focusedRangeInternal[1] === 0) {
      const dayOffset = (0, _dateFns.differenceInCalendarDays)(endDate || now, startDate);
      const calculateEndDate = () => {
        if (moveRangeOnFirstSelection) {
          return (0, _dateFns.addDays)(value, dayOffset);
        }
        if (retainEndDateOnFirstSelection) {
          if (!endDate || (0, _dateFns.isBefore)(value, endDate)) {
            return endDate;
          }
          return value;
        }
        return value || now;
      };
      startDate = value;
      endDate = calculateEndDate();
      if (maxDate) endDate = (0, _dateFns.min)([endDate, maxDate]);
      nextFocusRange = [focusedRangeInternal[0], 1];
    } else {
      endDate = value;
    }

    // reverse dates if startDate before endDate
    let isStartDateSelected = focusedRangeInternal[1] === 0;
    if ((0, _dateFns.isBefore)(endDate, startDate)) {
      isStartDateSelected = !isStartDateSelected;
      [startDate, endDate] = [endDate, startDate];
    }
    const inValidDatesWithinRange = disabledDates.filter(disabledDate => (0, _dateFns.isWithinInterval)(disabledDate, {
      start: startDate,
      end: endDate
    }));
    if (inValidDatesWithinRange.length > 0) {
      if (isStartDateSelected) {
        startDate = (0, _dateFns.addDays)((0, _dateFns.max)(inValidDatesWithinRange), 1);
      } else {
        endDate = (0, _dateFns.addDays)((0, _dateFns.min)(inValidDatesWithinRange), -1);
      }
    }
    if (!nextFocusRange) {
      const nextFocusRangeIndex = (0, _utils.findNextRangeIndex)(ranges, focusedRangeInternal[0]);
      nextFocusRange = [nextFocusRangeIndex, 0];
    }
    return {
      wasValid: !(inValidDatesWithinRange.length > 0),
      range: {
        startDate,
        endDate
      },
      nextFocusRange: nextFocusRange
    };
  };
  const setSelection = (value, isSingleValue) => {
    const focusedRangeIndex = (focusedRange || state.focusedRange)[0];
    const selectedRange = ranges[focusedRangeIndex];
    if (!selectedRange || !onChange) return;
    const newSelection = calcNewSelection(value, isSingleValue);
    const toChange = {
      [selectedRange.key || `range${focusedRangeIndex + 1}`]: {
        ...selectedRange,
        ...newSelection.range
      }
    };
    onChange?.(toChange);
    setState(s => ({
      ...s,
      focusedRange: newSelection.nextFocusRange,
      preview: null
    }));
    onRangeFocusChange?.(newSelection.nextFocusRange);
  };
  const handleRangeFocusChange = focusedRange => {
    setState(s => ({
      ...s,
      focusedRange
    }));
    onRangeFocusChange?.(focusedRange);
  };
  const updatePreview = val => {
    if (!val) {
      setState(s => ({
        ...s,
        preview: null
      }));
      return;
    }
    const focusedRangeInternal = focusedRange || state.focusedRange;
    const colorInternal = ranges[focusedRangeInternal[0]]?.color || rangeColors[focusedRangeInternal[0]] || color;
    setState(s => ({
      ...s,
      preview: {
        ...val.range,
        color: colorInternal
      }
    }));
  };
  return /*#__PURE__*/_react.default.createElement(_Calendar.default, {
    focusedRange: focusedRange || state.focusedRange,
    onRangeFocusChange: handleRangeFocusChange,
    preview: preview || state.preview,
    onPreviewChange: value => {
      updatePreview(value ? calcNewSelection(value) : null);
    },
    ariaLabels: ariaLabels,
    weekStartsOn: weekStartsOn,
    weekdayDisplayFormat: weekdayDisplayFormat,
    editableDateInputs: editableDateInputs,
    endDatePlaceholder: endDatePlaceholder,
    showMonthAndYearPickers: showMonthAndYearPickers,
    onShownDateChange: onShownDateChange,
    preventSnapRefocus: preventSnapRefocus,
    scroll: scroll,
    showDateDisplay: showDateDisplay,
    showMonthArrow: showMonthArrow,
    showPreview: showPreview,
    shownDate: shownDate,
    startDatePlaceholder: startDatePlaceholder,
    date: date,
    dateDisplayFormat: dateDisplayFormat,
    dayContentRenderer: dayContentRenderer,
    dayDisplayFormat: dayDisplayFormat,
    direction: direction,
    disabledDay: disabledDay,
    dragSelectionEnabled: dragSelectionEnabled,
    fixedHeight: fixedHeight,
    locale: locale,
    calendarFocus: calendarFocus,
    displayMode: "dateRange",
    className: (0, _classnames.default)(refs.current.styles.dateRangeWrapper, className),
    onChange: setSelection,
    updateRange: val => setSelection(val, false),
    monthDisplayFormat: monthDisplayFormat,
    months: months,
    classNames: classNames,
    ranges: ranges,
    rangeColors: rangeColors,
    disabledDates: disabledDates,
    initialFocusedRange: initialFocusedRange,
    maxDate: maxDate,
    minDate: minDate,
    color: color,
    preventScrollToFocusedMonth: preventScrollToFocusedMonth
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9DYWxlbmRhciIsIl91dGlscyIsIl9zdHlsZXMiLCJfZGF0ZUZucyIsIl9jbGFzc25hbWVzIiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJEYXRlUmFuZ2UiLCJfcmVmIiwiYXJpYUxhYmVscyIsIndlZWtTdGFydHNPbiIsIndlZWtkYXlEaXNwbGF5Rm9ybWF0IiwiZWRpdGFibGVEYXRlSW5wdXRzIiwiZW5kRGF0ZVBsYWNlaG9sZGVyIiwic2hvd01vbnRoQW5kWWVhclBpY2tlcnMiLCJvblNob3duRGF0ZUNoYW5nZSIsInByZXZlbnRTbmFwUmVmb2N1cyIsInByZXZpZXciLCJzY3JvbGwiLCJzaG93RGF0ZURpc3BsYXkiLCJzaG93TW9udGhBcnJvdyIsInNob3dQcmV2aWV3Iiwic2hvd25EYXRlIiwic3RhcnREYXRlUGxhY2Vob2xkZXIiLCJkYXRlIiwiZGF0ZURpc3BsYXlGb3JtYXQiLCJkYXlDb250ZW50UmVuZGVyZXIiLCJkYXlEaXNwbGF5Rm9ybWF0IiwiZGlyZWN0aW9uIiwiZGlzYWJsZWREYXkiLCJkcmFnU2VsZWN0aW9uRW5hYmxlZCIsImZpeGVkSGVpZ2h0IiwibG9jYWxlIiwiY2FsZW5kYXJGb2N1cyIsImNsYXNzTmFtZSIsIm1vbnRoRGlzcGxheUZvcm1hdCIsIm1vbnRocyIsIm9uQ2hhbmdlIiwiY2xhc3NOYW1lcyIsInJhbmdlcyIsIm1vdmVSYW5nZU9uRmlyc3RTZWxlY3Rpb24iLCJyZXRhaW5FbmREYXRlT25GaXJzdFNlbGVjdGlvbiIsInJhbmdlQ29sb3JzIiwiZGlzYWJsZWREYXRlcyIsImluaXRpYWxGb2N1c2VkUmFuZ2UiLCJmb2N1c2VkUmFuZ2UiLCJtYXhEYXRlIiwibWluRGF0ZSIsIm9uUmFuZ2VGb2N1c0NoYW5nZSIsImNvbG9yIiwicHJldmlld1JhbmdlIiwicHJldmVudFNjcm9sbFRvRm9jdXNlZE1vbnRoIiwicmVmcyIsIlJlYWN0IiwidXNlUmVmIiwic3R5bGVzIiwiZ2VuZXJhdGVTdHlsZXMiLCJTdHlsZXMiLCJzdGF0ZSIsInNldFN0YXRlIiwidXNlU3RhdGUiLCJmaW5kTmV4dFJhbmdlSW5kZXgiLCJ1c2VFZmZlY3QiLCJ1cGRhdGVQcmV2aWV3IiwiY2FsY05ld1NlbGVjdGlvbiIsImVuZERhdGUiLCJ2YWx1ZSIsImlzU2luZ2xlVmFsdWUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJmb2N1c2VkUmFuZ2VJbnRlcm5hbCIsImZvY3VzZWRSYW5nZUluZGV4Iiwic2VsZWN0ZWRSYW5nZSIsInN0YXJ0RGF0ZSIsIm5vdyIsIkRhdGUiLCJuZXh0Rm9jdXNSYW5nZSIsImRheU9mZnNldCIsImRpZmZlcmVuY2VJbkNhbGVuZGFyRGF5cyIsImNhbGN1bGF0ZUVuZERhdGUiLCJhZGREYXlzIiwiaXNCZWZvcmUiLCJtaW4iLCJpc1N0YXJ0RGF0ZVNlbGVjdGVkIiwiaW5WYWxpZERhdGVzV2l0aGluUmFuZ2UiLCJmaWx0ZXIiLCJkaXNhYmxlZERhdGUiLCJpc1dpdGhpbkludGVydmFsIiwic3RhcnQiLCJlbmQiLCJtYXgiLCJuZXh0Rm9jdXNSYW5nZUluZGV4Iiwid2FzVmFsaWQiLCJyYW5nZSIsInNldFNlbGVjdGlvbiIsIm5ld1NlbGVjdGlvbiIsInRvQ2hhbmdlIiwia2V5IiwicyIsImhhbmRsZVJhbmdlRm9jdXNDaGFuZ2UiLCJ2YWwiLCJjb2xvckludGVybmFsIiwiY3JlYXRlRWxlbWVudCIsIm9uUHJldmlld0NoYW5nZSIsImRpc3BsYXlNb2RlIiwiY2xhc3NuYW1lcyIsImN1cnJlbnQiLCJkYXRlUmFuZ2VXcmFwcGVyIiwidXBkYXRlUmFuZ2UiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9EYXRlUmFuZ2UvaW5kZXgudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgQ2FsZW5kYXIsIHsgQ2FsZW5kYXJQcm9wcyB9IGZyb20gJy4uL0NhbGVuZGFyJztcbmltcG9ydCB7IHR5cGUgRGF0ZVJhbmdlIH0gZnJvbSAnLi4vRGF5Q2VsbCc7XG5pbXBvcnQgeyBmaW5kTmV4dFJhbmdlSW5kZXgsIGdlbmVyYXRlU3R5bGVzIH0gZnJvbSAnLi4vLi4vdXRpbHMnO1xuaW1wb3J0IFN0eWxlcyBmcm9tICcuLi8uLi9zdHlsZXMnO1xuaW1wb3J0IHsgYWRkRGF5cywgZGlmZmVyZW5jZUluQ2FsZW5kYXJEYXlzLCBpc0JlZm9yZSwgaXNXaXRoaW5JbnRlcnZhbCwgbWF4LCBtaW4gfSBmcm9tICdkYXRlLWZucyc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuZXhwb3J0IHR5cGUgRGF0ZVJhbmdlUHJvcHMgPSB7XG4gIG9uQ2hhbmdlOiAoZGF0ZVJhbmdlOiBEYXRlUmFuZ2UpID0+IHZvaWQsXG4gIG9uUmFuZ2VGb2N1c0NoYW5nZT86IChyYW5nZTogbnVtYmVyW10pID0+IHZvaWQsXG4gIGNsYXNzTmFtZT86IHN0cmluZyxcbiAgcmFuZ2VzPzogRGF0ZVJhbmdlW10sXG4gIG1vdmVSYW5nZU9uRmlyc3RTZWxlY3Rpb24/OiBib29sZWFuLFxuICByZXRhaW5FbmREYXRlT25GaXJzdFNlbGVjdGlvbj86IGJvb2xlYW4sXG4gIHByZXZpZXdSYW5nZT86IERhdGVSYW5nZSxcbn0gJiBDYWxlbmRhclByb3BzO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEYXRlUmFuZ2Uoe1xuICBhcmlhTGFiZWxzLFxuICB3ZWVrU3RhcnRzT24sXG4gIHdlZWtkYXlEaXNwbGF5Rm9ybWF0LFxuICBlZGl0YWJsZURhdGVJbnB1dHMsXG4gIGVuZERhdGVQbGFjZWhvbGRlcixcbiAgc2hvd01vbnRoQW5kWWVhclBpY2tlcnMsXG4gIG9uU2hvd25EYXRlQ2hhbmdlLFxuICBwcmV2ZW50U25hcFJlZm9jdXMsXG4gIHByZXZpZXcsXG4gIHNjcm9sbCxcbiAgc2hvd0RhdGVEaXNwbGF5LFxuICBzaG93TW9udGhBcnJvdyxcbiAgc2hvd1ByZXZpZXcsXG4gIHNob3duRGF0ZSxcbiAgc3RhcnREYXRlUGxhY2Vob2xkZXIsXG4gIGRhdGUsXG4gIGRhdGVEaXNwbGF5Rm9ybWF0LFxuICBkYXlDb250ZW50UmVuZGVyZXIsXG4gIGRheURpc3BsYXlGb3JtYXQsXG4gIGRpcmVjdGlvbixcbiAgZGlzYWJsZWREYXksXG4gIGRyYWdTZWxlY3Rpb25FbmFibGVkLFxuICBmaXhlZEhlaWdodCxcbiAgbG9jYWxlLFxuICBjYWxlbmRhckZvY3VzLFxuICBjbGFzc05hbWUsXG4gIG1vbnRoRGlzcGxheUZvcm1hdCxcbiAgbW9udGhzLFxuICBvbkNoYW5nZSxcbiAgY2xhc3NOYW1lcyA9IHt9LFxuICByYW5nZXMgPSBbXSxcbiAgbW92ZVJhbmdlT25GaXJzdFNlbGVjdGlvbiA9IGZhbHNlLFxuICByZXRhaW5FbmREYXRlT25GaXJzdFNlbGVjdGlvbiA9IGZhbHNlLFxuICByYW5nZUNvbG9ycyA9IFsnIzNkOTFmZicsICcjM2VjZjhlJywgJyNmZWQxNGMnXSxcbiAgZGlzYWJsZWREYXRlcyA9IFtdLFxuICBpbml0aWFsRm9jdXNlZFJhbmdlLFxuICBmb2N1c2VkUmFuZ2UsXG4gIG1heERhdGUsXG4gIG1pbkRhdGUsXG4gIG9uUmFuZ2VGb2N1c0NoYW5nZSxcbiAgY29sb3IsXG4gIHByZXZpZXdSYW5nZSxcbiAgcHJldmVudFNjcm9sbFRvRm9jdXNlZE1vbnRoXG59OiBEYXRlUmFuZ2VQcm9wcykge1xuXG4gIGNvbnN0IHJlZnMgPSBSZWFjdC51c2VSZWYoe1xuICAgIHN0eWxlczogZ2VuZXJhdGVTdHlsZXMoW1N0eWxlcywgY2xhc3NOYW1lc10pXG4gIH0pO1xuXG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgIGZvY3VzZWRSYW5nZTogaW5pdGlhbEZvY3VzZWRSYW5nZSB8fCBbZmluZE5leHRSYW5nZUluZGV4KHJhbmdlcywgMCldLFxuICAgIHByZXZpZXc6IG51bGxcbiAgfSk7XG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICB1cGRhdGVQcmV2aWV3KHByZXZpZXdSYW5nZSA/IGNhbGNOZXdTZWxlY3Rpb24ocHJldmlld1JhbmdlLCAhcHJldmlld1JhbmdlLmVuZERhdGUpIDogbnVsbClcbiAgfSwgW3ByZXZpZXdSYW5nZV0pO1xuXG4gIGNvbnN0IGNhbGNOZXdTZWxlY3Rpb24gPSAodmFsdWU6IERhdGVSYW5nZSB8IERhdGUsIGlzU2luZ2xlVmFsdWUgPSB0cnVlKSA9PiB7XG4gICAgY29uc3QgZm9jdXNlZFJhbmdlSW50ZXJuYWwgPSAoZm9jdXNlZFJhbmdlIHx8IHN0YXRlLmZvY3VzZWRSYW5nZSk7XG4gICAgY29uc3QgZm9jdXNlZFJhbmdlSW5kZXggPSBmb2N1c2VkUmFuZ2VJbnRlcm5hbFswXTtcbiAgICBjb25zdCBzZWxlY3RlZFJhbmdlID0gcmFuZ2VzW2ZvY3VzZWRSYW5nZUluZGV4XTtcblxuICAgIGlmICghc2VsZWN0ZWRSYW5nZSB8fCAhb25DaGFuZ2UpIHJldHVybiB7fTtcblxuICAgIGxldCB7IHN0YXJ0RGF0ZSwgZW5kRGF0ZSB9ID0gc2VsZWN0ZWRSYW5nZTtcblxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICBsZXQgbmV4dEZvY3VzUmFuZ2U6IHVuZGVmaW5lZCB8IG51bWJlcltdO1xuXG4gICAgaWYgKCFpc1NpbmdsZVZhbHVlKSB7XG4gICAgICBzdGFydERhdGUgPSAodmFsdWUgYXMgRGF0ZVJhbmdlKS5zdGFydERhdGU7XG4gICAgICBlbmREYXRlID0gKHZhbHVlIGFzIERhdGVSYW5nZSkuZW5kRGF0ZTtcbiAgICB9IGVsc2UgaWYgKGZvY3VzZWRSYW5nZUludGVybmFsWzFdID09PSAwKSB7XG4gICAgICBjb25zdCBkYXlPZmZzZXQgPSBkaWZmZXJlbmNlSW5DYWxlbmRhckRheXMoZW5kRGF0ZSB8fCBub3csIHN0YXJ0RGF0ZSk7XG5cbiAgICAgIGNvbnN0IGNhbGN1bGF0ZUVuZERhdGUgPSAoKSA9PiB7XG4gICAgICAgIGlmIChtb3ZlUmFuZ2VPbkZpcnN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuIGFkZERheXModmFsdWUgYXMgRGF0ZSwgZGF5T2Zmc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXRhaW5FbmREYXRlT25GaXJzdFNlbGVjdGlvbikge1xuICAgICAgICAgIGlmICghZW5kRGF0ZSB8fCBpc0JlZm9yZSh2YWx1ZSBhcyBEYXRlLCBlbmREYXRlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGVuZERhdGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZSBhcyBEYXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICh2YWx1ZSBhcyBEYXRlIHx8IG5vdyk7XG4gICAgICB9XG5cbiAgICAgIHN0YXJ0RGF0ZSA9IHZhbHVlIGFzIERhdGU7XG4gICAgICBlbmREYXRlID0gY2FsY3VsYXRlRW5kRGF0ZSgpO1xuICAgICAgaWYgKG1heERhdGUpIGVuZERhdGUgPSBtaW4oW2VuZERhdGUsIG1heERhdGVdKTtcblxuICAgICAgbmV4dEZvY3VzUmFuZ2UgPSBbZm9jdXNlZFJhbmdlSW50ZXJuYWxbMF0sIDFdO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmREYXRlID0gdmFsdWUgYXMgRGF0ZTtcbiAgICB9XG5cbiAgICAvLyByZXZlcnNlIGRhdGVzIGlmIHN0YXJ0RGF0ZSBiZWZvcmUgZW5kRGF0ZVxuICAgIGxldCBpc1N0YXJ0RGF0ZVNlbGVjdGVkID0gZm9jdXNlZFJhbmdlSW50ZXJuYWxbMV0gPT09IDA7XG4gICAgaWYgKGlzQmVmb3JlKGVuZERhdGUsIHN0YXJ0RGF0ZSkpIHtcbiAgICAgIGlzU3RhcnREYXRlU2VsZWN0ZWQgPSAhaXNTdGFydERhdGVTZWxlY3RlZDtcbiAgICAgIFtzdGFydERhdGUsIGVuZERhdGVdID0gW2VuZERhdGUsIHN0YXJ0RGF0ZV07XG4gICAgfVxuXG4gICAgY29uc3QgaW5WYWxpZERhdGVzV2l0aGluUmFuZ2UgPSBkaXNhYmxlZERhdGVzLmZpbHRlcihkaXNhYmxlZERhdGUgPT5cbiAgICAgIGlzV2l0aGluSW50ZXJ2YWwoZGlzYWJsZWREYXRlLCB7XG4gICAgICAgIHN0YXJ0OiBzdGFydERhdGUsXG4gICAgICAgIGVuZDogZW5kRGF0ZSxcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIGlmIChpblZhbGlkRGF0ZXNXaXRoaW5SYW5nZS5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoaXNTdGFydERhdGVTZWxlY3RlZCkge1xuICAgICAgICBzdGFydERhdGUgPSBhZGREYXlzKG1heChpblZhbGlkRGF0ZXNXaXRoaW5SYW5nZSksIDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZW5kRGF0ZSA9IGFkZERheXMobWluKGluVmFsaWREYXRlc1dpdGhpblJhbmdlKSwgLTEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghbmV4dEZvY3VzUmFuZ2UpIHtcbiAgICAgIGNvbnN0IG5leHRGb2N1c1JhbmdlSW5kZXggPSBmaW5kTmV4dFJhbmdlSW5kZXgocmFuZ2VzLCBmb2N1c2VkUmFuZ2VJbnRlcm5hbFswXSk7XG4gICAgICBuZXh0Rm9jdXNSYW5nZSA9IFtuZXh0Rm9jdXNSYW5nZUluZGV4LCAwXTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2FzVmFsaWQ6ICEoaW5WYWxpZERhdGVzV2l0aGluUmFuZ2UubGVuZ3RoID4gMCksXG4gICAgICByYW5nZTogeyBzdGFydERhdGUsIGVuZERhdGUgfSxcbiAgICAgIG5leHRGb2N1c1JhbmdlOiBuZXh0Rm9jdXNSYW5nZSxcbiAgICB9O1xuXG4gIH1cblxuICBjb25zdCBzZXRTZWxlY3Rpb24gPSAodmFsdWU6IERhdGVSYW5nZSB8IERhdGUsIGlzU2luZ2xlVmFsdWU/OiBib29sZWFuKSA9PiB7XG4gICAgY29uc3QgZm9jdXNlZFJhbmdlSW5kZXggPSAoZm9jdXNlZFJhbmdlIHx8IHN0YXRlLmZvY3VzZWRSYW5nZSlbMF07XG5cbiAgICBjb25zdCBzZWxlY3RlZFJhbmdlID0gcmFuZ2VzW2ZvY3VzZWRSYW5nZUluZGV4XTtcbiAgICBpZiAoIXNlbGVjdGVkUmFuZ2UgfHwgIW9uQ2hhbmdlKSByZXR1cm47XG5cbiAgICBjb25zdCBuZXdTZWxlY3Rpb24gPSBjYWxjTmV3U2VsZWN0aW9uKHZhbHVlLCBpc1NpbmdsZVZhbHVlKTtcblxuICAgIGNvbnN0IHRvQ2hhbmdlID0ge1xuICAgICAgW3NlbGVjdGVkUmFuZ2Uua2V5IHx8IGByYW5nZSR7Zm9jdXNlZFJhbmdlSW5kZXggKyAxfWBdOiB7XG4gICAgICAgIC4uLnNlbGVjdGVkUmFuZ2UsXG4gICAgICAgIC4uLm5ld1NlbGVjdGlvbi5yYW5nZSxcbiAgICAgIH0sXG4gICAgfTtcbiAgICBcbiAgICBvbkNoYW5nZT8uKHRvQ2hhbmdlIGFzIHVua25vd24gYXMgRGF0ZVJhbmdlKTtcblxuICAgIHNldFN0YXRlKHMgPT4gKHsgLi4ucywgZm9jdXNlZFJhbmdlOiBuZXdTZWxlY3Rpb24ubmV4dEZvY3VzUmFuZ2UsIHByZXZpZXc6IG51bGwgfSkpO1xuXG4gICAgb25SYW5nZUZvY3VzQ2hhbmdlPy4obmV3U2VsZWN0aW9uLm5leHRGb2N1c1JhbmdlKTtcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZVJhbmdlRm9jdXNDaGFuZ2UgPSAoZm9jdXNlZFJhbmdlOiBudW1iZXJbXSkgPT4ge1xuICAgIHNldFN0YXRlKHMgPT4gKHsgLi4ucywgZm9jdXNlZFJhbmdlIH0pKTtcbiAgICBvblJhbmdlRm9jdXNDaGFuZ2U/Lihmb2N1c2VkUmFuZ2UpO1xuICB9XG5cbiAgY29uc3QgdXBkYXRlUHJldmlldyA9ICh2YWw/OiB7XG4gICAgd2FzVmFsaWQ/OiBib29sZWFuLFxuICAgIHJhbmdlPzogRGF0ZVJhbmdlLFxuICAgIG5leHRGb2N1c1JhbmdlPzogbnVtYmVyW10sXG4gIH0pID0+IHtcblxuICAgIGlmICghdmFsKSB7XG4gICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHByZXZpZXc6IG51bGwgfSkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGZvY3VzZWRSYW5nZUludGVybmFsID0gZm9jdXNlZFJhbmdlIHx8IHN0YXRlLmZvY3VzZWRSYW5nZTtcbiAgICBjb25zdCBjb2xvckludGVybmFsID0gcmFuZ2VzW2ZvY3VzZWRSYW5nZUludGVybmFsWzBdXT8uY29sb3IgfHwgcmFuZ2VDb2xvcnNbZm9jdXNlZFJhbmdlSW50ZXJuYWxbMF1dIHx8IGNvbG9yO1xuXG4gICAgc2V0U3RhdGUoKHMgPT4gKHsgLi4ucywgcHJldmlldzogeyAuLi52YWwucmFuZ2UsIGNvbG9yOiBjb2xvckludGVybmFsIH0gfSkpKTtcbiAgfVxuICBcbiAgcmV0dXJuIChcbiAgICA8Q2FsZW5kYXJcbiAgICAgIGZvY3VzZWRSYW5nZT17Zm9jdXNlZFJhbmdlIHx8IHN0YXRlLmZvY3VzZWRSYW5nZX1cbiAgICAgIG9uUmFuZ2VGb2N1c0NoYW5nZT17aGFuZGxlUmFuZ2VGb2N1c0NoYW5nZX1cbiAgICAgIHByZXZpZXc9e3ByZXZpZXcgfHwgc3RhdGUucHJldmlld31cbiAgICAgIG9uUHJldmlld0NoYW5nZT17dmFsdWUgPT4ge1xuICAgICAgICB1cGRhdGVQcmV2aWV3KHZhbHVlID8gY2FsY05ld1NlbGVjdGlvbih2YWx1ZSkgOiBudWxsKTtcbiAgICAgIH19XG4gICAgICBhcmlhTGFiZWxzPXthcmlhTGFiZWxzfVxuICAgICAgd2Vla1N0YXJ0c09uPXt3ZWVrU3RhcnRzT259XG4gICAgICB3ZWVrZGF5RGlzcGxheUZvcm1hdD17d2Vla2RheURpc3BsYXlGb3JtYXR9XG4gICAgICBlZGl0YWJsZURhdGVJbnB1dHM9e2VkaXRhYmxlRGF0ZUlucHV0c31cbiAgICAgIGVuZERhdGVQbGFjZWhvbGRlcj17ZW5kRGF0ZVBsYWNlaG9sZGVyfVxuICAgICAgc2hvd01vbnRoQW5kWWVhclBpY2tlcnM9e3Nob3dNb250aEFuZFllYXJQaWNrZXJzfVxuICAgICAgb25TaG93bkRhdGVDaGFuZ2U9e29uU2hvd25EYXRlQ2hhbmdlfVxuICAgICAgcHJldmVudFNuYXBSZWZvY3VzPXtwcmV2ZW50U25hcFJlZm9jdXN9XG4gICAgICBzY3JvbGw9e3Njcm9sbH1cbiAgICAgIHNob3dEYXRlRGlzcGxheT17c2hvd0RhdGVEaXNwbGF5fVxuICAgICAgc2hvd01vbnRoQXJyb3c9e3Nob3dNb250aEFycm93fVxuICAgICAgc2hvd1ByZXZpZXc9e3Nob3dQcmV2aWV3fVxuICAgICAgc2hvd25EYXRlPXtzaG93bkRhdGV9XG4gICAgICBzdGFydERhdGVQbGFjZWhvbGRlcj17c3RhcnREYXRlUGxhY2Vob2xkZXJ9XG4gICAgICBkYXRlPXtkYXRlfVxuICAgICAgZGF0ZURpc3BsYXlGb3JtYXQ9e2RhdGVEaXNwbGF5Rm9ybWF0fVxuICAgICAgZGF5Q29udGVudFJlbmRlcmVyPXtkYXlDb250ZW50UmVuZGVyZXJ9XG4gICAgICBkYXlEaXNwbGF5Rm9ybWF0PXtkYXlEaXNwbGF5Rm9ybWF0fVxuICAgICAgZGlyZWN0aW9uPXtkaXJlY3Rpb259XG4gICAgICBkaXNhYmxlZERheT17ZGlzYWJsZWREYXl9XG4gICAgICBkcmFnU2VsZWN0aW9uRW5hYmxlZD17ZHJhZ1NlbGVjdGlvbkVuYWJsZWR9XG4gICAgICBmaXhlZEhlaWdodD17Zml4ZWRIZWlnaHR9XG4gICAgICBsb2NhbGU9e2xvY2FsZX1cbiAgICAgIGNhbGVuZGFyRm9jdXM9e2NhbGVuZGFyRm9jdXN9XG4gICAgICBkaXNwbGF5TW9kZT0nZGF0ZVJhbmdlJ1xuICAgICAgY2xhc3NOYW1lPXtjbGFzc25hbWVzKHJlZnMuY3VycmVudC5zdHlsZXMuZGF0ZVJhbmdlV3JhcHBlciwgY2xhc3NOYW1lKX1cbiAgICAgIG9uQ2hhbmdlPXtzZXRTZWxlY3Rpb259XG4gICAgICB1cGRhdGVSYW5nZT17dmFsID0+IHNldFNlbGVjdGlvbih2YWwsIGZhbHNlKX1cbiAgICAgIG1vbnRoRGlzcGxheUZvcm1hdD17bW9udGhEaXNwbGF5Rm9ybWF0fVxuICAgICAgbW9udGhzPXttb250aHN9XG4gICAgICBjbGFzc05hbWVzPXtjbGFzc05hbWVzfVxuICAgICAgcmFuZ2VzPXtyYW5nZXN9XG4gICAgICByYW5nZUNvbG9ycz17cmFuZ2VDb2xvcnN9XG4gICAgICBkaXNhYmxlZERhdGVzPXtkaXNhYmxlZERhdGVzfVxuICAgICAgaW5pdGlhbEZvY3VzZWRSYW5nZT17aW5pdGlhbEZvY3VzZWRSYW5nZX1cbiAgICAgIG1heERhdGU9e21heERhdGV9XG4gICAgICBtaW5EYXRlPXttaW5EYXRlfVxuICAgICAgY29sb3I9e2NvbG9yfVxuICAgICAgcHJldmVudFNjcm9sbFRvRm9jdXNlZE1vbnRoPXtwcmV2ZW50U2Nyb2xsVG9Gb2N1c2VkTW9udGh9XG4gICAgLz5cbiAgKVxufSAiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE1BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUVBLElBQUFFLE1BQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFFBQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLFdBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUFvQyxTQUFBRCx1QkFBQU8sR0FBQSxXQUFBQSxHQUFBLElBQUFBLEdBQUEsQ0FBQUMsVUFBQSxHQUFBRCxHQUFBLEtBQUFFLE9BQUEsRUFBQUYsR0FBQTtBQVlyQixTQUFTRyxTQUFTQSxDQUFBQyxJQUFBLEVBNENkO0VBQUEsSUE1Q2U7SUFDaENDLFVBQVU7SUFDVkMsWUFBWTtJQUNaQyxvQkFBb0I7SUFDcEJDLGtCQUFrQjtJQUNsQkMsa0JBQWtCO0lBQ2xCQyx1QkFBdUI7SUFDdkJDLGlCQUFpQjtJQUNqQkMsa0JBQWtCO0lBQ2xCQyxPQUFPO0lBQ1BDLE1BQU07SUFDTkMsZUFBZTtJQUNmQyxjQUFjO0lBQ2RDLFdBQVc7SUFDWEMsU0FBUztJQUNUQyxvQkFBb0I7SUFDcEJDLElBQUk7SUFDSkMsaUJBQWlCO0lBQ2pCQyxrQkFBa0I7SUFDbEJDLGdCQUFnQjtJQUNoQkMsU0FBUztJQUNUQyxXQUFXO0lBQ1hDLG9CQUFvQjtJ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